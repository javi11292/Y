---
import { GET as GETAll } from "$api/post/all/[...page]";
import { GET as GetFollowing } from "$api/post/following/[...page]";
import type { LoggedAstroGlobal } from "$lib/types";

const [posts, following] = await Promise.all([
	GETAll(Astro).then((response) => response.json()),
	GetFollowing(Astro as LoggedAstroGlobal).then((response) => response.json()),
]);
---

<astro-load id="home" data-load={JSON.stringify({ posts, following })}></astro-load>

<script>
	import { getData } from "$lib/commons/utils/load";
	import { load } from "./load";

	load(getData("home"));
</script>
